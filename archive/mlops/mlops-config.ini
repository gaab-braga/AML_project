# AML Pipeline MLOps Configuration
# This file contains all MLOps-related configurations

# ========================================================================
# MLFLOW CONFIGURATION
# ========================================================================

[mlflow]
tracking_uri = http://localhost:5000
artifact_store_uri = ./mlops/artifacts
registry_uri = http://localhost:5000
model_registry_db_uri = sqlite:///mlops/mlflow.db
mlflow_ui_host = 0.0.0.0
mlflow_ui_port = 5000

# ========================================================================
# MODEL REGISTRY CONFIGURATION
# ========================================================================

[model_registry]
enable_versioning = true
auto_version_increment = true
stages = development,staging,production,archived
store_metadata = true
metadata_fields = author,description,training_data_version,validation_metrics,production_date,retirement_date
enable_validation = true
validation_metrics = accuracy,precision,recall,f1_score,auc_roc

# ========================================================================
# EXPERIMENT TRACKING
# ========================================================================

[experiment_tracking]
experiment_name = aml_pipeline_experiments
enable_autologging = true
tracking_metrics = accuracy,precision,recall,f1_score,auc_roc,log_loss,training_time,inference_time
tracking_parameters = model_type,learning_rate,batch_size,epochs,feature_count,data_size
store_artifacts = true
artifact_types = model,feature_importance,confusion_matrix,roc_curve,calibration_curve

# ========================================================================
# DATA VALIDATION CONFIGURATION
# ========================================================================

[data_validation]
missing_value_threshold = 0.1
duplicate_threshold = 0.05
outlier_method = iqr
outlier_threshold = 1.5
schema_validation = true

# ========================================================================
# MODEL RETRAINING CONFIGURATION
# ========================================================================

[model_retraining]
enable_automatic_retraining = true
retraining_triggers = performance_degradation,data_drift,time_based,data_validation_failure
performance_thresholds_accuracy_drop = 0.05
performance_thresholds_precision_drop = 0.10
performance_thresholds_recall_drop = 0.10
performance_thresholds_f1_drop = 0.08
drift_detection_enabled = true
drift_threshold = 0.05
significance_level = 0.05
drift_check_interval_hours = 24
retraining_circuit_failure_threshold = 3
retraining_circuit_recovery_timeout = 3600
mlflow_circuit_failure_threshold = 5
mlflow_circuit_recovery_timeout = 1800
drift_circuit_failure_threshold = 3
drift_circuit_recovery_timeout = 1800
max_performance_history = 1000
baseline_window_days = 30
min_baseline_size = 10
confidence_level = 0.95
enable_statistical_tests = true
minimum_sample_size = 30
time_based_retraining_days = 30
enable_data_validation = true
enable_data_cleaning = true
health_check_interval_seconds = 300

# ========================================================================
# A/B TESTING CONFIGURATION
# ========================================================================

[ab_testing]
enable_ab_testing = true
testing_framework = scipy
confidence_level = 0.95
minimum_sample_size = 1000
maximum_test_duration_days = 30
primary_metric = precision
secondary_metrics = recall,accuracy,false_positive_rate
default_traffic_split = 0.5
minimum_traffic_per_variant = 0.1
statistical_tests = t_test,mann_whitney,chi_square,z_test

# ========================================================================
# FEATURE STORE CONFIGURATION
# ========================================================================

[feature_store]
backend = feast
feature_store_uri = ./mlops/feature_store
enable_feature_versioning = true
feature_validation_enabled = true
feature_metadata_fields = name,description,data_type,feature_type,owner,last_updated
online_serving_enabled = true
batch_serving_enabled = true
feature_drift_monitoring = true
feature_quality_monitoring = true

# ========================================================================
# MONITORING & ALERTING
# ========================================================================

[ml_monitoring]
performance_monitoring_enabled = true
performance_check_interval_hours = 1
data_drift_enabled = true
concept_drift_enabled = true
drift_detection_method = alibi_detect
alerting_enabled = true
alert_channels = email,slack,webhook
alert_thresholds_performance_drop = 0.05
alert_thresholds_drift_score = 0.1
alert_thresholds_prediction_error_rate = 0.05

# ========================================================================
# INFRASTRUCTURE CONFIGURATION
# ========================================================================

[ml_infrastructure]
training_instance_type = ml.m5.large
inference_instance_type = ml.t2.medium
model_storage_bucket = aml-pipeline-models
artifact_storage_bucket = aml-pipeline-artifacts
vpc_id = vpc-12345678
subnet_ids = subnet-12345678,subnet-87654321
security_group_id = sg-12345678

# ========================================================================
# COMPLIANCE & GOVERNANCE
# ========================================================================

[ml_governance]
model_approval_required = true
model_documentation_required = true
audit_logging_enabled = true
audit_log_retention_days = 2555
automated_compliance_checks = true
compliance_frameworks = SOX,GDPR,PCI-DSS
model_explainability_required = true
explainability_methods = shap,lime,permutation_importance

# ========================================================================
# DEVELOPMENT & TESTING
# ========================================================================

[ml_development]
development_mode = true
mock_external_services = true
unit_test_coverage_threshold = 80
integration_test_enabled = true
performance_test_enabled = true
debug_mode = false
verbose_logging = false

# ========================================================================
# COST OPTIMIZATION
# ========================================================================

[ml_cost_optimization]
auto_shutdown_idle_instances = true
idle_timeout_minutes = 30
cost_monitoring_enabled = true
monthly_budget_limit = 1000
use_spot_instances = true
spot_instance_max_price = 0.1

# ========================================================================
# ADVANCED FEATURES
# ========================================================================

[ml_advanced]
automl_enabled = false
automl_framework = auto_sklearn
ensemble_methods_enabled = true
ensemble_strategies = voting,stacking,blending
hpo_enabled = true
hpo_method = optuna
hpo_max_trials = 100
model_compression_enabled = false
compression_methods = quantization,pruning,distillation